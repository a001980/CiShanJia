/*
活动名称：店铺刮刮乐
活动链接：https://shop.m.jd.com/shop/lottery?shopId=<店铺id>&venderId=<店主id>
环境变量：jd_shopLottery_activityUrl // 活动链接
        jd_shopLottery_Notify // 是否推送通知（true/false），默认不推送

注：活动链接变量只提供店主id即可，但访问活动需要同时包含店铺id和店主id

*/

const $ = new Env('店铺刮刮乐')
const jdCookie = require('./jdCookie')
const common = require('./function/jdCommon')
const notify = require('./function/sendJDNotify')
const getSign = require('./function/getSign')

var version_='jsjiami.com.v7';const III1l1iI=iIi1iIli;(function(III1,ll1Iiil1,IlI1IiI1,Ili11I11,lIlIli,illII1li,lIlIiIiI){return III1=III1>>0x7,illII1li='hs',lIlIiIiI='hs',function(lIliiliI,Ii1i1lil,ili1IiII,iliIiill,li1liIiI){const lili111l=iIi1iIli;iliIiill='tfi',illII1li=iliIiill+illII1li,li1liIiI='up',lIlIiIiI+=li1liIiI,illII1li=ili1IiII(illII1li),lIlIiIiI=ili1IiII(lIlIiIiI),ili1IiII=0x0;const lIi1Iil=lIliiliI();while(!![]&&--Ili11I11+Ii1i1lil){try{iliIiill=parseInt(lili111l(0x2c6,'9OQT'))/0x1*(-parseInt(lili111l(0x287,'zZHa'))/0x2)+parseInt(lili111l(0x24a,'W[Ae'))/0x3+parseInt(lili111l(0x25d,'A446'))/0x4+-parseInt(lili111l(0x29d,'w8U4'))/0x5*(parseInt(lili111l(0x1d8,'fX9s'))/0x6)+parseInt(lili111l(0x246,'TMma'))/0x7+-parseInt(lili111l(0x1cd,'tZ%H'))/0x8+parseInt(lili111l(0x2cd,'zZHa'))/0x9;}catch(lIil1ll1){iliIiill=ili1IiII;}finally{li1liIiI=lIi1Iil[illII1li]();if(III1<=Ili11I11)ili1IiII?lIlIli?iliIiill=li1liIiI:lIlIli=li1liIiI:ili1IiII=li1liIiI;else{if(ili1IiII==lIlIli['replace'](/[EgtCHBhrFKGUpYbqedON=]/g,'')){if(iliIiill===Ii1i1lil){lIi1Iil['un'+illII1li](li1liIiI);break;}lIi1Iil[lIlIiIiI](li1liIiI);}}}}}(IlI1IiI1,ll1Iiil1,function(iIIilII,II1iIIl,lllI1ll1,Il1IilIi,llIIliI1,III1I1i1,IiiIli1){return II1iIIl='\x73\x70\x6c\x69\x74',iIIilII=arguments[0x0],iIIilII=iIIilII[II1iIIl](''),lllI1ll1=`\x72\x65\x76\x65\x72\x73\x65`,iIIilII=iIIilII[lllI1ll1]('\x76'),Il1IilIi=`\x6a\x6f\x69\x6e`,(0x13b0f6,iIIilII[Il1IilIi](''));});}(0x6400,0xa99d1,iIIl1IIl,0xca),iIIl1IIl)&&(version_=iIIl1IIl);const activityUrl=process[III1l1iI(0x22a,'s&AD')][III1l1iI(0x2db,'zHSU')]||'',isNotify=process[III1l1iI(0x22a,'s&AD')][III1l1iI(0x1ad,'9OQT')]===III1l1iI(0x25c,'b2u7');let cookie='';const cookiesArr=Object[III1l1iI(0x1d5,'!Oy$')](jdCookie)[III1l1iI(0x221,'A446')](iI11i1=>jdCookie[iI11i1])[III1l1iI(0x2e2,'s%3I')](IIllI1i1=>IIllI1i1);!cookiesArr[0x0]&&($[III1l1iI(0x278,'9Li3')]($[III1l1iI(0x293,'iiC8')],III1l1iI(0x263,'fX9s')),process[III1l1iI(0x283,'fX9s')](0x1));!(async()=>{const lIiIll11=III1l1iI,iil1ilIi={'uzdqh':lIiIll11(0x1b8,'HUuC'),'dAkue':lIiIll11(0x21f,'Wl8s'),'oUOBE':lIiIll11(0x2e5,'0VPb'),'RPSqv':function(lIl1IiIl,i1i1l11I){return lIl1IiIl!==i1i1l11I;},'TfIOh':lIiIll11(0x26e,'w8U4'),'BAhEB':lIiIll11(0x215,'Wl8s'),'OmAra':lIiIll11(0x1f9,'fX9s'),'EcKZw':lIiIll11(0x1ec,'TMma'),'JBVAV':function(lIlii1l,iiIiliII){return lIlii1l<iiIiliII;},'QIgiI':function(i1Ii1i,ii1l111){return i1Ii1i===ii1l111;},'RqsNg':lIiIll11(0x274,'qztv'),'GkZXL':lIiIll11(0x280,'W[Ae'),'TAEKQ':function(illiii1,IIillilI){return illiii1+IIillilI;},'srIAH':function(ilil1l){return ilil1l();},'IFbsl':function(II1i1l1l,iilI1Ii1){return II1i1l1l(iilI1Ii1);},'pMfZj':lIiIll11(0x2cb,'[6zY'),'BLsLR':function(lI1II111,I1IiIIiI){return lI1II111===I1IiIIiI;},'SYYam':lIiIll11(0x2e0,'W[Ae'),'yZeLU':lIiIll11(0x245,'1zRi'),'scLHe':function(l1iIlIli,III1l1ii){return l1iIlIli+III1l1ii;}};if(!activityUrl){console[lIiIll11(0x240,'[6zY')](iil1ilIi[lIiIll11(0x2d6,'HUuC')]);return;}const lll1iill=common[lIiIll11(0x28c,'q$$H')](activityUrl);if(!lll1iill){if(iil1ilIi[lIiIll11(0x2b0,'HUuC')](iil1ilIi[lIiIll11(0x2a1,'$Vto')],iil1ilIi[lIiIll11(0x233,'x(mG')])){console[lIiIll11(0x2c3,'W[Ae')](iil1ilIi[lIiIll11(0x2ad,'PgWY')]);return;}else IiI1IIl1[lIiIll11(0x284,'q$$H')](I1lliil,llIliiIi);}$[lIiIll11(0x218,'tZ%H')]=activityUrl,$[lIiIll11(0x2d5,'jqYG')]=common[lIiIll11(0x286,'R78g')](activityUrl,iil1ilIi[lIiIll11(0x23c,'zHSU')]);if(!$[lIiIll11(0x212,'@Y3I')]){console[lIiIll11(0x1fa,'HUuC')](iil1ilIi[lIiIll11(0x1c2,'fX9s')]);return;}notify[lIiIll11(0x210,'W)Qq')]({'title':$[lIiIll11(0x1ed,'fX9s')]}),console[lIiIll11(0x2d7,'0d9V')](lIiIll11(0x1bc,'W)Qq')+$[lIiIll11(0x23a,'!Oy$')]);for(let iIIili1=0x0;iil1ilIi[lIiIll11(0x1e3,'s%3I')](iIIili1,cookiesArr[lIiIll11(0x1ee,'@Y3I')]);iIIili1++){if(iil1ilIi[lIiIll11(0x29c,'q$$H')](iil1ilIi[lIiIll11(0x1c9,'G&@j')],iil1ilIi[lIiIll11(0x214,'(Ob1')])){const I1li1ll=iil1ilIi[lIiIll11(0x2ea,'1zRi')][lIiIll11(0x2c0,'dtM5')]('|');let I11iil1I=0x0;while(!![]){switch(I1li1ll[I11iil1I++]){case'0':$[lIiIll11(0x26d,'YH(M')]=iil1ilIi[lIiIll11(0x207,'R78g')](iIIili1,0x1);continue;case'1':console[lIiIll11(0x2f2,'YH(M')](lIiIll11(0x267,'0d9V')+$[lIiIll11(0x2a0,'!Oy$')]+'】'+($[lIiIll11(0x1ba,'Wl8s')]||$[lIiIll11(0x2e3,'pmLy')])+lIiIll11(0x247,'9OQT'));continue;case'2':await iil1ilIi[lIiIll11(0x2f3,'HUuC')](Main);continue;case'3':cookie=cookiesArr[iIIili1];continue;case'4':$['UA']=common[lIiIll11(0x1c6,'R78g')]($[lIiIll11(0x2f4,'YH(M')]);continue;case'5':$[lIiIll11(0x1e9,'tifT')]=notify[lIiIll11(0x1be,'b2u7')]($[lIiIll11(0x270,'TMma')],$[lIiIll11(0x2ba,'$Vto')]);continue;case'6':$[lIiIll11(0x2b7,'@PzJ')]='';continue;case'7':$[lIiIll11(0x205,'&e5!')]=iil1ilIi[lIiIll11(0x27f,'s&AD')](decodeURIComponent,common[lIiIll11(0x2c1,'iiC8')](cookie,iil1ilIi[lIiIll11(0x2ef,'&e5!')]));continue;}break;}}else iIil1I11[lIiIll11(0x290,'A446')](iil1ilIi[lIiIll11(0x2a8,'Wl8s')]),li1IliiI[lIiIll11(0x1ac,'f%[K')][lIiIll11(0x1ce,'9OQT')](iil1ilIi[lIiIll11(0x231,'b2u7')]),il11111[lIiIll11(0x256,'iiC8')]=!![];}if(isNotify&&notify[lIiIll11(0x1d0,'VKsy')]()){if(iil1ilIi[lIiIll11(0x250,'f%[K')](iil1ilIi[lIiIll11(0x1d6,'pmLy')],iil1ilIi[lIiIll11(0x1c4,'R78g')])){lIIilil[lIiIll11(0x1bf,'w8U4')](iil1ilIi[lIiIll11(0x24e,'^2Zi')]);return;}else notify[lIiIll11(0x1b0,'zZHa')](iil1ilIi[lIiIll11(0x1b9,'f%[K')](notify[lIiIll11(0x2d0,'3kf)')],lIiIll11(0x1e4,'A446')+$[lIiIll11(0x27d,'@Y3I')])),await notify[lIiIll11(0x219,'HUuC')]();}})()[III1l1iI(0x2c9,'tZ%H')](l1i1=>console[III1l1iI(0x2d1,'0VPb')](l1i1))[III1l1iI(0x2c7,'zZHa')](()=>$[III1l1iI(0x211,'(Ob1')]());async function Main(){const l1l11=III1l1iI,llliiliI={'HkvJG':function(lIililI1,lI1Il1il){return lIililI1(lI1Il1il);},'SIVuY':function(ilI1II){return ilI1II();},'bqMWI':l1l11(0x1d4,'f%[K'),'djTec':function(II1illI1,IIll1iI1){return II1illI1===IIll1iI1;},'FZVKH':function(iiIllI1l,i1lll1l){return iiIllI1l(i1lll1l);},'iRcCI':l1l11(0x24b,'^2Zi'),'imGIA':function(IllIIi1l,Iilil1Ii){return IllIIi1l===Iilil1Ii;},'QBEux':l1l11(0x265,'zHSU'),'CELEa':l1l11(0x24f,'Wl8s'),'vcVyq':l1l11(0x2e9,'x(mG'),'dUepo':l1l11(0x2c8,'jqYG'),'rSaqL':function(l1IIlIl1,II1i1lll){return l1IIlIl1(II1i1lll);},'pCcjT':l1l11(0x299,'$Vto')};$[l1l11(0x2a4,'&e5!')]=![],await llliiliI[l1l11(0x2dd,'Wl8s')](getLoginStatus);if($[l1l11(0x1ae,'x(mG')])return;await llliiliI[l1l11(0x1eb,'w8U4')](sendRequest,llliiliI[l1l11(0x244,'CITL')]),llliiliI[l1l11(0x2de,'G&@j')]($[l1l11(0x1c7,'q$$H')],0x1)&&await llliiliI[l1l11(0x23f,'&OmQ')](sendRequest,llliiliI[l1l11(0x1c5,'PgWY')]),llliiliI[l1l11(0x1e6,'CITL')]($[l1l11(0x20b,'W)Qq')],0x2)?llliiliI[l1l11(0x1af,'PpIZ')](llliiliI[l1l11(0x2ca,'A446')],llliiliI[l1l11(0x26b,'R78g')])?llliiliI[l1l11(0x2c4,'0VPb')](iI1i1I1l,I111111):(console[l1l11(0x20e,'&OmQ')](llliiliI[l1l11(0x275,'tifT')]),$[l1l11(0x1c8,'VKsy')][l1l11(0x2ac,'3kf)')](llliiliI[l1l11(0x206,'HUuC')])):(await llliiliI[l1l11(0x27a,'Wl8s')](sendRequest,llliiliI[l1l11(0x1d3,'TMma')]),await $[l1l11(0x223,'W)Qq')](0x1f4));}async function sendRequest(l11I1Il){const ilIil1=III1l1iI,l11ll1ii={'xWqyx':function(IlIIill,IiiIi1iI){return IlIIill(IiiIi1iI);},'ZtBrY':function(Illi11i1,ilii11ll){return Illi11i1===ilii11ll;},'Oocpc':ilIil1(0x2e4,'&OmQ'),'wKjCX':function(illil1ii,i1i111li){return illil1ii===i1i111li;},'smSYM':ilIil1(0x21d,'1zRi'),'fEJUg':ilIil1(0x1e7,'1d0#'),'VzHfx':function(IIIIlI1,i1iiliIl){return IIIIlI1===i1iiliIl;},'XkRtc':function(lli1I1i,I111lII1){return lli1I1i===I111lII1;},'ZTeYr':ilIil1(0x2f1,'9Li3'),'XLdBb':ilIil1(0x1d2,'OBSq'),'GZeSa':ilIil1(0x2d9,'YH(M'),'vpDes':ilIil1(0x1fc,'q$$H'),'cfxSD':function(li1Iilli,lii1ill){return li1Iilli!==lii1ill;},'dthsV':ilIil1(0x2aa,'TMma'),'wYrpL':ilIil1(0x1d9,'PgWY'),'mUvxk':function(llilIiIl,llIll1iI){return llilIiIl+llIll1iI;},'GQLgs':ilIil1(0x1f1,'zHSU'),'VPBpz':ilIil1(0x1f4,'PgWY'),'DGKpD':ilIil1(0x21b,'w8U4'),'JIhPA':function(iIIliIiI,i1ii11Il){return iIIliIiI!==i1ii11Il;},'WlAiC':ilIil1(0x252,'jqYG'),'popXQ':ilIil1(0x1d7,'gzr5'),'akFFM':function(i1iIili,I1iIiIi){return i1iIili(I1iIiIi);},'wyvHh':ilIil1(0x1db,'PpIZ'),'XxYej':function(Ili111l,li1iii1i,lIi11i1){return Ili111l(li1iii1i,lIi11i1);},'byGMe':ilIil1(0x1bd,'9OQT'),'LklPG':ilIil1(0x281,'x(mG'),'mGHYD':ilIil1(0x2f8,'tZ%H'),'DsouQ':ilIil1(0x269,'pmLy'),'YbjYJ':ilIil1(0x21e,'fX9s'),'SfwNZ':ilIil1(0x236,'&OmQ'),'oLiQM':ilIil1(0x297,'5LkJ')};let iiIl1111='',I1iIIlI={};switch(l11I1Il){case l11ll1ii[ilIil1(0x23b,'OBSq')]:case l11ll1ii[ilIil1(0x203,'y6&Q')]:iiIl1111=l11I1Il,I1iIIlI={'vendorId':$[ilIil1(0x2d8,'x(mG')]};break;case l11ll1ii[ilIil1(0x1f7,'(Ob1')]:iiIl1111=l11I1Il,I1iIIlI={'vendorId':$[ilIil1(0x2d8,'x(mG')],'sourceRpc':l11ll1ii[ilIil1(0x1cc,'OBSq')]};break;}return new Promise(async liiIIIiI=>{const IIlllI1=ilIil1,lI1l111i={'EZlVi':l11ll1ii[IIlllI1(0x237,'9OQT')]},II1IIIIl=await l11ll1ii[IIlllI1(0x2a3,'HUuC')](getSign,iiIl1111,I1iIIlI),il11lilI={'url':IIlllI1(0x232,'TMma')+l11I1Il,'headers':{'Host':l11ll1ii[IIlllI1(0x202,'PpIZ')],'Content-Type':l11ll1ii[IIlllI1(0x224,'x(mG')],'Accept':l11ll1ii[IIlllI1(0x20a,'s%3I')],'Connection':l11ll1ii[IIlllI1(0x238,'b2u7')],'Cookie':cookie,'Accept-Language':l11ll1ii[IIlllI1(0x27e,'A446')],'Accept-Encoding':l11ll1ii[IIlllI1(0x26f,'9OQT')],'User-Agent':$['UA']},'body':II1IIIIl};$[IIlllI1(0x24c,'TMma')](il11lilI,(liliillI,ll1I1III,l1111iI)=>{const IlI1=IIlllI1,IIiliIii={'WyhND':function(I1i11I,ilIiliI1){const Il1i1Ii1=iIi1iIli;return l11ll1ii[Il1i1Ii1(0x1c1,'s&AD')](I1i11I,ilIiliI1);},'HfOvC':function(I1Iii1il,iIl1iIil){const iliili1=iIi1iIli;return l11ll1ii[iliili1(0x1c0,'1zRi')](I1Iii1il,iIl1iIil);},'aNeio':l11ll1ii[IlI1(0x2fa,'0VPb')]};try{if(l11ll1ii[IlI1(0x2be,'fX9s')](l11ll1ii[IlI1(0x28e,'&OmQ')],l11ll1ii[IlI1(0x24d,'1d0#')]))l1lllliI[IlI1(0x1c3,'W)Qq')](IIiliIii[IlI1(0x1bb,'fX9s')](iilIi1il,illlIli1));else{if(liliillI)console[IlI1(0x2b1,'$Vto')](l11ll1ii[IlI1(0x1f2,'iiC8')](String,liliillI));else{l1111iI=JSON[IlI1(0x273,'b2u7')](l1111iI);if(l11ll1ii[IlI1(0x2eb,'PpIZ')](l1111iI[IlI1(0x268,'0VPb')],'0')){if(l11ll1ii[IlI1(0x2ec,'3kf)')](l11ll1ii[IlI1(0x2f9,'q$$H')],l11ll1ii[IlI1(0x225,'0VPb')]))llIiIili[IlI1(0x1fd,'dtM5')](IliiiIII);else switch(l11I1Il){case l11ll1ii[IlI1(0x294,'^2Zi')]:$[IlI1(0x239,'y6&Q')]=l1111iI[IlI1(0x272,'qztv')][IlI1(0x2b2,'gzr5')][IlI1(0x298,'0d9V')];break;case l11ll1ii[IlI1(0x2bd,'5LkJ')]:for(let iIi1Iili of l1111iI[IlI1(0x1b7,'0d9V')][IlI1(0x243,'f%[K')]){if(l11ll1ii[IlI1(0x21a,'q$$H')](l11ll1ii[IlI1(0x235,'Wl8s')],l11ll1ii[IlI1(0x2bf,'0d9V')]))console[IlI1(0x2e7,'zZHa')](iIi1Iili),notify[IlI1(0x285,'VKsy')](l11ll1ii[IlI1(0x279,'gzr5')](notify[IlI1(0x27c,'(Ob1')],'\x0a'+iIi1Iili));else{lllIiIli[IlI1(0x2da,'OBSq')](lI1l111i[IlI1(0x2df,'jqYG')]);return;}}console[IlI1(0x2d7,'0d9V')]('');break;case l11ll1ii[IlI1(0x1ea,'@Y3I')]:if(l1111iI[IlI1(0x2b8,'tZ%H')][IlI1(0x22d,'jqYG')]){const l1lIiiii=l1111iI[IlI1(0x229,'VKsy')][IlI1(0x228,'@PzJ')][IlI1(0x1e2,'9OQT')]||'';console[IlI1(0x2b4,'5LkJ')](IlI1(0x2d4,'zZHa')+l1lIiiii[IlI1(0x29a,'1d0#')]('：')[0x1]),$[IlI1(0x1e1,'[6zY')][IlI1(0x296,'0VPb')](l1lIiiii);}else l11ll1ii[IlI1(0x2b6,'YH(M')](l11ll1ii[IlI1(0x251,'w8U4')],l11ll1ii[IlI1(0x28f,'W[Ae')])?(console[IlI1(0x1f3,'y6&Q')](l11ll1ii[IlI1(0x1b3,'gzr5')]),$[IlI1(0x22f,'9OQT')][IlI1(0x1b6,'pmLy')]('空气')):(Il1iiiiI[IlI1(0x2c2,'PpIZ')](IlI1(0x258,'fX9s')),l1Ii1ilI[IlI1(0x2b3,'&OmQ')]=!![]);break;}}else console[IlI1(0x241,'CITL')](l1111iI);}}}catch(IlIi){console[IlI1(0x2c5,'9Li3')](IlIi,ll1I1III);}finally{l11ll1ii[IlI1(0x271,'&OmQ')](l11ll1ii[IlI1(0x20c,'!Oy$')],l11ll1ii[IlI1(0x209,'CITL')])?l11ll1ii[IlI1(0x2a7,'w8U4')](liiIIIiI,l1111iI):(illiiIII=II11lI1I[IlI1(0x1f0,'tifT')](liil11I1),IIiliIii[IlI1(0x288,'W)Qq')](I1Iii1Ii[IlI1(0x234,'&OmQ')],'0')&&(ll1I1I11[IlI1(0x1fd,'dtM5')](IIiliIii[IlI1(0x2e8,'Wl8s')]),liilll1l[IlI1(0x266,'gzr5')][IlI1(0x2ae,'f%[K')](IIiliIii[IlI1(0x1b2,'YH(M')]),IiII[IlI1(0x1b4,'tifT')]=!![]));}});});}function iIi1iIli(_0x3d6c9d,_0x2aabcc){const _0x735d8b=iIIl1IIl();return iIi1iIli=function(_0x4d1d8d,_0x2133f2){_0x4d1d8d=_0x4d1d8d-0x1ac;let _0xe880d5=_0x735d8b[_0x4d1d8d];if(iIi1iIli['mNwFcQ']===undefined){var _0x174220=function(_0xab245f){const _0x25fcb8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1c385b='',_0x3b7c34='';for(let _0xbbffcb=0x0,_0x3db25d,_0x15da98,_0x29aa06=0x0;_0x15da98=_0xab245f['charAt'](_0x29aa06++);~_0x15da98&&(_0x3db25d=_0xbbffcb%0x4?_0x3db25d*0x40+_0x15da98:_0x15da98,_0xbbffcb++%0x4)?_0x1c385b+=String['fromCharCode'](0xff&_0x3db25d>>(-0x2*_0xbbffcb&0x6)):0x0){_0x15da98=_0x25fcb8['indexOf'](_0x15da98);}for(let _0x3b065a=0x0,_0x325ee4=_0x1c385b['length'];_0x3b065a<_0x325ee4;_0x3b065a++){_0x3b7c34+='%'+('00'+_0x1c385b['charCodeAt'](_0x3b065a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3b7c34);};const _0x77b86e=function(_0x9282eb,_0x39ed3c){let _0x4e60d6=[],_0x590704=0x0,_0x26c29d,_0x3dac5c='';_0x9282eb=_0x174220(_0x9282eb);let _0x237f62;for(_0x237f62=0x0;_0x237f62<0x100;_0x237f62++){_0x4e60d6[_0x237f62]=_0x237f62;}for(_0x237f62=0x0;_0x237f62<0x100;_0x237f62++){_0x590704=(_0x590704+_0x4e60d6[_0x237f62]+_0x39ed3c['charCodeAt'](_0x237f62%_0x39ed3c['length']))%0x100,_0x26c29d=_0x4e60d6[_0x237f62],_0x4e60d6[_0x237f62]=_0x4e60d6[_0x590704],_0x4e60d6[_0x590704]=_0x26c29d;}_0x237f62=0x0,_0x590704=0x0;for(let _0x2fcffe=0x0;_0x2fcffe<_0x9282eb['length'];_0x2fcffe++){_0x237f62=(_0x237f62+0x1)%0x100,_0x590704=(_0x590704+_0x4e60d6[_0x237f62])%0x100,_0x26c29d=_0x4e60d6[_0x237f62],_0x4e60d6[_0x237f62]=_0x4e60d6[_0x590704],_0x4e60d6[_0x590704]=_0x26c29d,_0x3dac5c+=String['fromCharCode'](_0x9282eb['charCodeAt'](_0x2fcffe)^_0x4e60d6[(_0x4e60d6[_0x237f62]+_0x4e60d6[_0x590704])%0x100]);}return _0x3dac5c;};iIi1iIli['MLBwNU']=_0x77b86e,_0x3d6c9d=arguments,iIi1iIli['mNwFcQ']=!![];}const _0x1fbd1d=_0x735d8b[0x0],_0x32154b=_0x4d1d8d+_0x1fbd1d,_0x7db20e=_0x3d6c9d[_0x32154b];return!_0x7db20e?(iIi1iIli['XoYqtc']===undefined&&(iIi1iIli['XoYqtc']=!![]),_0xe880d5=iIi1iIli['MLBwNU'](_0xe880d5,_0x2133f2),_0x3d6c9d[_0x32154b]=_0xe880d5):_0xe880d5=_0x7db20e,_0xe880d5;},iIi1iIli(_0x3d6c9d,_0x2aabcc);}function iIIl1IIl(){const ll1lIll=(function(){return[...[version_,'egjGGEsKjqiHapCmhi.cHBoUmF.ev7dNbYprbpOt==','W57dGCkCeG','WQVcU8oMWQPSWRdcJH58ca','dwVdI8o6Ca','BrfzpCoq','W5jaW4a','gXFdR8oyW70','qeVdUhVdJG','FaBcGHrV','E2TkxIm','CCkPW7O1W7i','FSoOpCk2W4PX','W4FdUmksWOyM','vCoRgSksW6C','WR0nzmo8vG','zCk4qqhcTmkNhW','u8kuW6yvW4aepCo4W49ZW6CHW63dI1LhWPP+WQxcKmk1lCoiemo0WP0eWQ3dQ8kKW7pdVehcLmo/W4ZcK8kuWRxcUSoiwW','WRZcSSoN','nSk8WO3dG8oz','WRmww8kXW6i','crVdH8kEWQu','WQ82BmoMdXlcHG','h0VdPmkEsSkUfZivW4VdMa','ESkQe37cJa','iJpdICkzWQa','lmoFWR/dGtNcUCkAx8krWP0EWOvHWQZcLa','y8kQWOtdGCkGqSoyC8oZcSoTxfFdTCoPi8kSW69cW6fhW6pdL8ouWO7cLgjvjeVcMG4N','mdVdMCoeW44','cthdMs0','W5jaW4bjxgu','lCosW51jWP5YbmoCWOVcRutdR8oL','stfHlCodW5ldSY7cTMCDt8opiSo6','zCoZW5RdMblcIrhdNsZcPuC','hCkQyCkXWPK','WQxcHCoXqLm','taJdObdORB/MS5ZLPkBOT7JVVPtORPdMOiVMNP/NV4ZOTkZPHipORAS','y2VdQfi','W45oW5v/s0ldLga','W5/dNmkOWRS0','smknW4e8W74','sSoZW47dJxq','t8kNhG','icZdQCkSWOu','44gh5OYA56Es44o76k+r5yA46i+k5y2sf8kfBmkjDCoK','W4JdObJcGG','suRcTeOy','W5pdJ8kveG','W5tdGmkleSkUca','D8kgydSIW79HW5JcMSooF8oStColWOSPWQtdMG','k8odW7GFWRNcJa','W7VdRmkrWQO','WOC5exSA','W5BdGHRcQmow','W69MW4bLzW','bWBcQLddVJddOmoKW7C','Dh7cLxOu','zmklWOddOCka','FmkafmokW4e','W5ZdO8k/WOTh','W71WW5SbWQi','lwddN8oOsq','lCoMW77dS8k4WRyA','hmkVWRJcS0q','iSoJW41GWOS','u1RdMu/dPq','WRq/xSkXW4y','v8kScCoLW40','re5fCXK','DIeJjSkn','W5LRW7K','WReVkv3cTa','WPxcISk3','jmkFWQFcKLm','j0JdLCo8vq','W6tdQSkr','kmkaWPZdLCo7W4G+WQS','smklW7SvW6flFa','AmkbAa','l8odW4W','btldOCo+W50','x8oXW6/cOuldNmkQxa','WOTkW4RcUeDT','r8k3jSoOW5O','W53dTSktWRzHp8ovla','BCkcW4CuW7G','lbjvW7W4','CSkEsY4o','gWldMHRdKa','nCoPW5KgWPi','DwpdRu8O','W4hdPahcPmodf8omWOJdSCkpnbOpW50','W5BdNWC','CmomW6S','W7xdHCkopCkB','WR3cRSoNrfHG','f1BcKcnXDwOM','mCkJWOBcI0RcNaq','5lUz5Awf5BAY5y6v5lUB6lYE','WPPoW43cRKm','CSkkpflcVG','dH54W6y1AG','W5RdVCkVWQyU','B8oYW5JdNHxdH0VdPJJcNLRcOe4','ECkbf8oQW4VcPq','xL7dUeZdMIu','W5XTW688WOPaWRa','W5hdGCkFmSkUdG','imo4W7OXWO8','WOW0WRv/W54FW7W4W6FdNWJdKmom','8kQ9G8oi','zqKUm8kWWQVcG8kB','gK3dICopzG'],...(function(){return[...['lSoFW4W','Dmk/WPRdICkSu8oWyW','frZdV8oUW6XAW4BdTaJcINC','jL5e','oCoKWOhdUJq3z8kYWPmkWRBcHh8vW4nppSkRsGmWhdFcPmo7aa','WQ0kheJcJq','WPimBmk1W7C','WPFcUmoucWe','vJySaCk8','ACotW6pdRwm','WPKZwmkkW48','Cmk6raxcG8kG','WPxcRCoMWQGpWRdcJXi','6lsD5yYx5PwY5PsT','4PIDWO7ORi/LHl/LRyBKUlxLVy/OPllNM7JNJkBLO7BLJitPHAxLKzRLHylOVOdOOBJOHQlMN4i','WPNcISogWPKn','o8kLWO8','WQalx8kPW4e','5lUi5AEZ5Bsg57MI5yYl5lIV6l2+5lQbW6q','WQpdL8oSW4xdHW','W6ZdIIHMyG','W6DPW5m8WOW','a8kUAmkEWQS','d8o8W5WsWQW','lSoaW7hdMCka','eCkMWRhcPeW','WRVcS8oPCMq','hHBdRa','bMRdJ8omAW','jWRdRSopW4TCW4xdMa','W4NdPs94BW','W6VdJqlcG8oE','WQGjwmoHhq','W5maWPm','W6r7W4jvxa','W7ldGCkBb8k/','WP7cHSk8a2HNvq','rqtcQILDtNyZoWpcLhDZpIRcGSosWQddVuSq','CCkXWP3dNCkBvmox','W5pdNsDjwW','iSk6WOZcI1lcLt7dQZRcNMBcJgG','WPm3kvFcOq','eZFdRSouW6O','h8kUWRddI8o2','WRGfw8o1DCk7W4W','W6tdTSk1whX1AdddGG','WQNcSmoWWR8ZWQu','mmovW5GdWRlcLG','6lwt5y+V5PwM5PEf','WOdcGmkdogW','WQ8SwCkRW6bKWOO1','oZddMbFdJa','5RwU5yMK5ywl5yYK77+a','tHdcNhryd2WBEHtcJ38','W5tdQ8kfWPq3aq','xL7dUa','WR7dImo0W6/dKG','eYldMSktWRq','caJdMYZdRq','oCkJsq','vW5WnmoK','WPCqc2ZcNa','stf7lCoW','W5DbW4nPvG','nCohW4PBWOTWiG','WQhcO8oZiau','dSkaWP7dKCo5','6lsW5yYK5PEi5Ps5','jx1kW6CJ','W44FWORdVb0TpsnEs8kTEqW','sqNcJq','nCkcWO7cSMq','p8ohW41LWO9KnmosWOlcVa','5lQc5lMi5PYy5yUz5zUz6l2Q5zM956I15PA05O2O','mMn1W5uh','yKznuq8','WPtcHSk7i2bNxMldNMvp','FSklcCoC','WPpcH8oAWRSS','p8kCWQRdGSoD','xxhcHwhcSmohC8kKW7imWPW','WPaLdwNcNG','W4DiW4rAyq','4PIAWPdORPFLHyJLROdKUj3LVPhOPi3NMy3NJylLOylLJiBPHP/LKPtLHyNOVl3OOA/OH5NMNBS','W4/dJCknhCk2','WP9gW4e','cCo8W60bWOC','W6pdOmktWRqcp8ouiexdKq','cmovW6K4WPC','eW9uW6u9y30','qqhcMd8','xmkrFJdcSa','kEodMoA1GUwkJ+wFTUwEHEocJq','nmkUBmkPWR0','DSoLW5BcNmkK','WRe6c0uF','iCkbW5BdUmo8WOOIWQWtW5pcUaxdTJRcLmo6vCkdvq','WQylqCo2rSkPW4C','oxNdNmkqtW','ELRdQupdRW','zgbaxZ7dNc0z','aIJdNtW','eK3dVSkqsmkV','dKNdOSkewq','WRSpqmo2qG','imoPWRNdPW','W57dLGtcNSou','WPBdN8ot','WRGPpwBcKa','W65VW4ChWOG','W7n8cmoYWPP8WOSjvCooW5y','WOSitSo1gq','ovPkW4y8W4RcSq'],...(function(){return['4PUmAEITH+wGSUweKEAIOUw8MoAUVUEJTUEBO+MqTEApNW','gxFdOq','4PQZtoIUT+wGVowfJoAJPEw/HEAUNoEHJ+EzKEMrPEAnHq','W41gW4bIB3tdKMu+WRSHeKxcNrNcVq','ANZdPG','umokW7/cUwi','x8o5W6hcRW','WPFdL8oFW63dMqNdTG','xIT3W5/ORQVMSyBLPkNOTiVVVyVOR4RMO5xMNBZNVBVOTPJPHRtORy4','W5JdIsDnFW','WOZdGmoWW6HH','WR4kDmoAbq','c8o+W7ldSCkKWQizW4y','eu3dO8o9ta','EHvqm8oG','BmkSWQBdVSkE','ySoGW7lcOCkw','E8kuycJcOG','pmk/FCkUWR0h','qSkcmCogW7O','gu3dPa','v8kpW7u','oHJdRCkLWQS','nSkJqmkHWRmo','WQG2Bmo3','ce3dVSktwCk1kI8','pgRdQCk9sa','WP4OCCoCdq','WOW9FmkAW4O','ymoIkq','WORcNSolrSoQsmk6W5GMW6a4WOxdSW','WPHmW43cPf1WEtfrumkm','bw3dTCoL','W51jW59FAG','8joYMCk/56MZ5Rk8','xCo3W6S','WRFdJmodW7hdKG','fIhcNrhdQCoWzmoWW5SPW7alWQddSG','4PMHzEIVJEwIQ+weT+AGUEw/QoASS+EHG+EyHEwnIUMeOG','WPxcT8oMWRak','tSkPcq','qgTnuYK','iSkTr8kZ','tSkXWPJdVCko','W6xdOSkCnCk+','WPhcMSorktm','eKFdTW','qSoXW6VcPf7dMmkWwmk6gG','kSohW4PDWOzJ','dHVdNq','yCoOpCkWW4DIW4q','sIqZo8kd','EH8xpSk7','W4RdRHi','qGxcHILurMm','W4VdPmoLfYzeW6hdOW','W4ldO8keWOqR','ENfAsYJcLeTsySoVWQJdKCoGW5jCWRdcGmojW6JdIdFdRwyhW5dcUmoZjSo2WQOuoCk1W740F8kTyg1MqmkrW7tcNf8o','qmkBWPZdQmkl','uSktW74kW5rxFa','WQuXuSkZW7G','xmkAW7SvWP8EDSkYW5LZW6KYW6hcIvDiW4y','wbNcGXjD','W7pdQSkpWOas','WPpdG8oNW6r1WRm','DmknbmogW4/cVSkiBvtdGMi','dwTgW6up','fSoJWPxdKYS','WQZcSCoK','W5H4W6G4W4moWQa1W5ldTdhdSCoHWRtcOwtcHq','FCk6W4qUW7S','eGva','FSoGW6u','W6tdUmk4obGMcsVdKH/cQSoiWR4','WPlcLmkUaM1evvJdK3fjsMhdKJhcGq','Cmo+W4/cRSko','WPZdPmoIW7FdVG','jZWwaMNcMLyXqSoAWOxcPCol','buRdN3aFcWW','i8oNeehdKCoGgvfKWQpcJSo6','xtX2oSo4','l8kvWRJcIJ/dTmkws8o3WQzWWQWy','FxNcTNC4W5CKWOaAW7hcPmoljsZcJCkb','yMPDtW','WPimn0Cj','ALhcUMWC','WO4dt8khW6W','WRhcR8k8pfS','zghdNxNdKG','Cd0UgCkg','ldZcQW','mCorW5vhWO1+kq','WOmGEmkrW4y','W5xdQHZcL8o+dCoj','bv57W4W7','5lUa5lMv5P695yU45zUG6l2k5zUj56QN5PEO5OYj','A8k4W67cVw9ViCkCWPakWPVcO18','eKDbW7Wp','W45dW4HRr3NcIgfMWRGXrxtcHXG','W4pdQ8kvWPa','fSo8qrFdSCo3W7tdLNS2W6BcHq','WRNcVCodW7Wxb8oCmfNdN8o7','gSo6WQ/dGJC','zYxcVHfN','5lQ65lUp5PYL5yUq5zQo6lYg5zQV56Mr5Pwg5O67','zCkbdx3cOG','44g85O6z56Ak44gi6k2/5yEw6i6G5yYlW5SiWQqrW7tcPG','bWnGW5qq','f8oRWRZdOXe','nSkmWOJdImotW4e9','smkAWOfCW7tdIe/LV6hLPQdJGlxKUi/KUklOTBpLJkK'];}())];}())];}());iIIl1IIl=function(){return ll1lIll;};return iIIl1IIl();};function getLoginStatus(){const l111IIll=III1l1iI,iliii1l={'KYBFI':l111IIll(0x1fb,'jqYG'),'HEKKR':function(I1i1iI1i,li1IiiI){return I1i1iI1i(li1IiiI);},'muAxt':l111IIll(0x292,'zZHa'),'BBRyK':function(IIl11lIi){return IIl11lIi();},'dPZsw':function(iliilI1l,illIilI1){return iliilI1l!==illIilI1;},'KePYb':l111IIll(0x1cf,'zZHa'),'shcBI':l111IIll(0x29f,'x(mG'),'RYVGc':function(lII11iIi,lIiI1lIl){return lII11iIi!==lIiI1lIl;},'yiGBL':l111IIll(0x257,'OBSq'),'abBng':function(I1Iii1li,IiIlli1I){return I1Iii1li===IiIlli1I;},'mdOSm':l111IIll(0x1cb,'s%3I'),'JeBNI':function(l1lllI1,iI1i1i1){return l1lllI1===iI1i1i1;},'zAtHa':l111IIll(0x2e6,'pmLy'),'Rnchr':l111IIll(0x1fe,'@PzJ'),'VbFYq':l111IIll(0x27b,'s&AD'),'VbUqK':l111IIll(0x2a2,'3kf)'),'hEHNw':function(Ii1iIIl){return Ii1iIIl();},'FlYNj':l111IIll(0x253,'dtM5'),'rcujj':l111IIll(0x23e,'3kf)'),'eMcqX':l111IIll(0x1e8,'gzr5'),'Rxrjd':l111IIll(0x1df,'$Vto'),'ygcVO':l111IIll(0x25b,'q$$H')};return new Promise(async I1i1I1il=>{const iiIilIii=l111IIll,ii1I11iI={'KLFwY':iliii1l[iiIilIii(0x291,'s&AD')],'XvbJa':function(iIl1IIli,Ii1I1iiI){const llllili=iiIilIii;return iliii1l[llllili(0x260,'9OQT')](iIl1IIli,Ii1I1iiI);},'znDcm':iliii1l[iiIilIii(0x1b1,'PgWY')],'FItZd':function(lii1IlII){const i11111l1=iiIilIii;return iliii1l[i11111l1(0x282,'YH(M')](lii1IlII);},'YHslV':function(IllliIl,ilIl1ll){const liII1lll=iiIilIii;return iliii1l[liII1lll(0x2f7,'(Ob1')](IllliIl,ilIl1ll);},'SHtgX':iliii1l[iiIilIii(0x2a5,'zZHa')],'tDqCy':iliii1l[iiIilIii(0x249,'R78g')],'BByJt':function(lii11ll,iIlll11i){const lIlIIIl1=iiIilIii;return iliii1l[lIlIIIl1(0x2b9,'!Oy$')](lii11ll,iIlll11i);},'bHQGQ':iliii1l[iiIilIii(0x264,'[6zY')],'MLwdr':function(ilIii111,iIiIllii){const iIiIIIll=iiIilIii;return iliii1l[iIiIIIll(0x1e5,'W)Qq')](ilIii111,iIiIllii);},'QmFOg':iliii1l[iiIilIii(0x2cc,'b2u7')],'rSvHo':function(IliIIl1i,lliI11){const li11liI=iiIilIii;return iliii1l[li11liI(0x1e0,'0d9V')](IliIIl1i,lliI11);},'nvRSW':iliii1l[iiIilIii(0x2a6,'VKsy')],'BeBQh':iliii1l[iiIilIii(0x222,'TMma')],'sUOxu':iliii1l[iiIilIii(0x2ed,'W)Qq')],'UiejK':iliii1l[iiIilIii(0x2bb,'&OmQ')],'pCoOz':function(IiI111Il){const ii11i1Ii=iiIilIii;return iliii1l[ii11i1Ii(0x28d,'b2u7')](IiI111Il);}},il1l1ll1={'url':iiIilIii(0x277,'&OmQ'),'headers':{'Accept':iliii1l[iiIilIii(0x2f0,'zZHa')],'Accept-Encoding':iliii1l[iiIilIii(0x1dc,'0VPb')],'Accept-Language':iliii1l[iiIilIii(0x2ab,'jqYG')],'Connection':iliii1l[iiIilIii(0x2bc,'[6zY')],'Cookie':cookie,'Host':iliii1l[iiIilIii(0x1da,'q$$H')],'User-Agent':$['UA']}};$[iiIilIii(0x20d,'@Y3I')](il1l1ll1,(i1I1l11i,III11i11,II11Il)=>{const iii1I11l=iiIilIii,I11IlIli={'IzqKk':ii1I11iI[iii1I11l(0x29e,'^2Zi')],'xsMwS':function(i1li1Il1){const iliIlII1=iii1I11l;return ii1I11iI[iliIlII1(0x262,'A446')](i1li1Il1);}};try{if(i1I1l11i){if(ii1I11iI[iii1I11l(0x22c,'jqYG')](ii1I11iI[iii1I11l(0x2dc,'PgWY')],ii1I11iI[iii1I11l(0x289,'9Li3')]))console[iii1I11l(0x26c,'q$$H')](ii1I11iI[iii1I11l(0x2e1,'Wl8s')](String,i1I1l11i)),console[iii1I11l(0x22e,'iiC8')]($[iii1I11l(0x295,'0VPb')]+iii1I11l(0x28a,'fX9s'));else{iiiIIi[iii1I11l(0x1fd,'dtM5')](ii1I11iI[iii1I11l(0x1de,'0d9V')]);return;}}else{if(II11Il){if(ii1I11iI[iii1I11l(0x213,'@Y3I')](ii1I11iI[iii1I11l(0x226,'G&@j')],ii1I11iI[iii1I11l(0x2d2,'0d9V')]))iIlii1I[iii1I11l(0x2b5,'0d9V')](i11liIiI[iii1I11l(0x1ff,'@PzJ')],I11IlIli[iii1I11l(0x25f,'zHSU')]),IllII1[iii1I11l(0x28b,'dtM5')](0x1);else try{II11Il=JSON[iii1I11l(0x1ef,'@Y3I')](II11Il),ii1I11iI[iii1I11l(0x2f6,'iiC8')](II11Il[iii1I11l(0x254,'VKsy')],'0')&&(console[iii1I11l(0x227,'@Y3I')](ii1I11iI[iii1I11l(0x1f5,'3kf)')]),$[iii1I11l(0x22b,'qztv')][iii1I11l(0x1dd,'tZ%H')](ii1I11iI[iii1I11l(0x20f,'s&AD')]),$[iii1I11l(0x276,'s%3I')]=!![]);}catch{ii1I11iI[iii1I11l(0x204,'(Ob1')](ii1I11iI[iii1I11l(0x208,'x(mG')],ii1I11iI[iii1I11l(0x255,'Wl8s')])?IlIlili1[iii1I11l(0x2cf,'w8U4')](liIliIII,li1liI1i):(console[iii1I11l(0x21c,'@PzJ')](iii1I11l(0x261,'s%3I')),$[iii1I11l(0x200,'1zRi')]=!![]);}}else console[iii1I11l(0x216,'qztv')](iii1I11l(0x1d1,'R78g')),$[iii1I11l(0x1f8,'OBSq')]=!![];}}catch(II111I1I){ii1I11iI[iii1I11l(0x2ee,'0d9V')](ii1I11iI[iii1I11l(0x2af,'zZHa')],ii1I11iI[iii1I11l(0x2f5,'PpIZ')])?console[iii1I11l(0x2ce,'!Oy$')](II111I1I,III11i11):(illlIIIl[iii1I11l(0x20e,'&OmQ')](ii1I11iI[iii1I11l(0x25a,'OBSq')](lIIillII,IlII1i11)),liii1I1l[iii1I11l(0x23d,'pmLy')](IIi1ilI1[iii1I11l(0x1e2,'9OQT')]+iii1I11l(0x201,'[6zY')));}finally{ii1I11iI[iii1I11l(0x2a9,'!Oy$')](ii1I11iI[iii1I11l(0x1ca,'gzr5')],ii1I11iI[iii1I11l(0x220,'pmLy')])?I11IlIli[iii1I11l(0x26a,'HUuC')](lil1liii):ii1I11iI[iii1I11l(0x29b,'iiC8')](I1i1I1il);}});});}var version_ = 'jsjiami.com.v7';

// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
